<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Résultats du Sondage</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #f4f4f4;
        }
    </style>
    <script src="script.js"></script>
</head>
<body>
    <h1>Résultats du Sondage - IoT Survey</h1>

    <table id="resultatsTable">
        <thead>
            <tr>
                <th>Adresse mail</th>
                <th>Rôle</th>
                <th>Utilisation de dispositifs IoT</th>
                <th>Types de dispositifs IoT</th>
                <th>Problèmes de sécurité</th>
                <th>Fréquence de surveillance</th>
                <th>Fonctionnalités intéressantes</th>
                <th>Méthode de notification</th>
                <th>Suggestions</th>
                <th>Informer des développements</th>
            </tr>
        </thead>
        <tbody>
            <!-- To insert data here -->
        </tbody>
    </table>

    <script>
        const url = "https://docs.google.com/spreadsheets/d/e/1jHQSpy5Vle6Jdu-X2JwLfxH8AuhCfif1lK3v6OzD3FU/pub?output=csv";

        async function fetchCSV() {
            const response = await fetch(url);
            const csvText = await response.text();
            const data = d3.csvParse(csvText);
            processCSV(data);
        }

        function processCSV(data) {
            const tableBody = document.querySelector("#resultatsTable tbody");

            data.forEach(row => {
                const rowElement = document.createElement("tr");
                rowElement.innerHTML = `
                    <td>${row["Adresse mail"]}</td>
                    <td>${row["Quel est votre rôle dans votre organisation ?"]}</td>
                    <td>${row["Utilisez-vous actuellement des dispositifs IoT dans votre environnement ?"]}</td>
                    <td>${row["Si oui, quels types de dispositifs IoT utilisez-vous ? (cochez toutes les réponses applicables)"]}</td>
                    <td>${row["Avez-vous déjà rencontré des problèmes de sécurité avec vos dispositifs IoT ?"]}</td>
                    <td>${row["À quelle fréquence surveillez vous l'état de vos dispositifs IoT ?"]}</td>
                    <td>${row["Quelles fonctionnalités seriez vous le plus intéressé à avoir dans un système de surveillance IoT ? (cochez toutes les réponses applicables)"]}</td>
                    <td>${row["Comment préférez-vous être averti en cas d'anomalie détectée ?"]}</td>
                    <td>${row["Avez-vous des suggestions ou des préoccupations concernant la sécurité des dispositifs IoT ?"]}</td>
                    <td>${row["Souhaitez-vous être informé des développements concernant ce projet ?"]}</td>
                `;
                tableBody.appendChild(rowElement);
            });
        }

        fetchCSV();
    </script>
</body>
</html>
